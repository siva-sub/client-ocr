<!DOCTYPE html>
<html>
<head>
    <title>Test PPU Models Loading</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>PPU Model Loading Test</h1>
    
    <div id="status"></div>
    
    <h2>Expected PPU Model URLs:</h2>
    <ul>
        <li>Detection: https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/PP-OCRv5_mobile_det_infer.onnx</li>
        <li>Recognition: https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/en_PP-OCRv4_mobile_rec_infer.onnx</li>
        <li>Dictionary: https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/en_dict.txt</li>
    </ul>
    
    <h2>Test Results:</h2>
    <div id="results"></div>
    
    <script>
        const statusDiv = document.getElementById('status');
        const resultsDiv = document.getElementById('results');
        
        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            statusDiv.appendChild(div);
        }
        
        function addResult(title, content, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${title}</strong><pre>${content}</pre>`;
            resultsDiv.appendChild(div);
        }
        
        async function testModelLoading() {
            addStatus('Starting PPU model loading test...', 'info');
            
            // Test PPU model URLs
            const ppuModels = [
                {
                    name: 'Detection Model',
                    url: 'https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/PP-OCRv5_mobile_det_infer.onnx'
                },
                {
                    name: 'Recognition Model',
                    url: 'https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/en_PP-OCRv4_mobile_rec_infer.onnx'
                },
                {
                    name: 'English Dictionary',
                    url: 'https://siva-sub.github.io/client-ocr/models/ppu-paddle-ocr/en_dict.txt'
                }
            ];
            
            for (const model of ppuModels) {
                try {
                    addStatus(`Testing ${model.name}...`, 'info');
                    
                    const response = await fetch(model.url, { method: 'HEAD' });
                    
                    if (response.ok) {
                        const size = response.headers.get('content-length');
                        const sizeInMB = size ? (parseInt(size) / 1024 / 1024).toFixed(2) : 'Unknown';
                        
                        addResult(
                            model.name,
                            `URL: ${model.url}\nStatus: ${response.status} ${response.statusText}\nSize: ${sizeInMB} MB`,
                            'success'
                        );
                    } else {
                        addResult(
                            model.name,
                            `URL: ${model.url}\nStatus: ${response.status} ${response.statusText}`,
                            'error'
                        );
                    }
                } catch (error) {
                    addResult(
                        model.name,
                        `URL: ${model.url}\nError: ${error.message}`,
                        'error'
                    );
                }
            }
            
            // Test model registry
            try {
                addStatus('Checking model registry configuration...', 'info');
                
                // This would normally import from the actual app, but for testing we'll check the network
                const appResponse = await fetch('/');
                if (appResponse.ok) {
                    addResult(
                        'App Status',
                        'Client OCR app is accessible at https://siva-sub.github.io/client-ocr/',
                        'success'
                    );
                }
            } catch (error) {
                addResult(
                    'App Status',
                    `Error accessing app: ${error.message}`,
                    'error'
                );
            }
        }
        
        // Run tests when page loads
        testModelLoading();
    </script>
</body>
</html>